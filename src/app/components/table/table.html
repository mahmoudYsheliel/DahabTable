<p-toast position="top-right" />
<p-table
  #dt
  [scrollable]="generatedTC().scrollable"
  [scrollHeight]="generatedTC().scrollHeight"
  [dataKey]="generatedTC().dataKey"
  [columns]="generatedTC().columns"
  [value]="data() || []"
  [loading]="generatedTC().isLoading"
  [size]="generatedTC().size"
  [showGridlines]="generatedTC().showGridlines"
  [stripedRows]="generatedTC().stripedRows"
  [paginator]="generatedTC().paginator"
  [rows]="generatedTC().rows || generatedTC().rowsPerPageOptions?.[0] || 10"
  [rowsPerPageOptions]="generatedTC().rowsPerPageOptions"
  [first]="generatedTC().first"
  [showCurrentPageReport]="generatedTC().showCurrentPageReport"
  [currentPageReportTemplate]="generatedTC().currentPageReportTemplate || ''"
  [lazy]="generatedTC().lazy"
  (onLazyLoad)="undefiendHandler(generatedTC().onLazyLoading, $event)"
  [totalRecords]="generatedTC().totalRecords || 0"
  [sortMode]="generatedTC().sortMode || 'single'"
  [(selection)]="selectedProducts"
  (onRowSelect)="undefiendHandler(generatedTC().onRowSelect, $event)"
  (onRowUnselect)="undefiendHandler(generatedTC().onRowUnselect, $event)"
  [expandedRowKeys]="expandedRows()"
  (onRowExpand)="undefiendHandler(generatedTC().onRowSelect, $event)"
  (onRowCollapse)="undefiendHandler(generatedTC().onRowSelect, $event)"
  [virtualScroll]="generatedTC().virtualScroll || false"
  [virtualScrollItemSize]="generatedTC().virtualScrollItemSize || 40"
  [scrollHeight]="generatedTC().scrollHeight || '600px'"
  [scrollable]="generatedTC().scrollable || false"
  (onEditInit)="onEditInit($event)"
  (onEditComplete)="onEditComplete($event)"
  [reorderableColumns]="generatedTC().reorderableColumns || false"
  (onFilter)="undefiendHandler(generatedTC().onFilter, $event)"
  (onSort)="undefiendHandler(generatedTC().onSort, $event)"
  (onPage)="undefiendHandler(generatedTC().onPage, $event)"
>
  <!----------- Passed Sections ----------->
  @if (generatedTC().captionTemplate && generatedTC().showCaption) {
  <ng-template #caption>
    <ng-container [ngTemplateOutlet]="generatedTC().captionTemplate"></ng-container>
  </ng-template>

  } @if (generatedTC().headerTemplate) {
  <ng-template #header>
    <ng-container
      [ngTemplateOutlet]="generatedTC().headerTemplate"
      [ngTemplateOutletContext]="{ $implicit: generatedTC().columns }"
    ></ng-container>
  </ng-template>

  } @if (generatedTC().bodyTemplate) {
  <ng-template #body let-product>
    <ng-container
      [ngTemplateOutlet]="generatedTC().bodyTemplate"
      [ngTemplateOutletContext]="{ $implicit: product, columns: generatedTC().columns }"
    ></ng-container>
  </ng-template>
  } @if (generatedTC().footerTemplate && generatedTC().showFooter) {
  <ng-template #footer>
    <ng-container [ngTemplateOutlet]="generatedTC().footerTemplate"></ng-container>
  </ng-template>

  } @if (generatedTC().expandable && generatedTC().expandedRowTempelate) {
  <ng-template #expandedrow let-product>
    <tr>
      <td colspan="100%">
        <ng-container
          [ngTemplateOutlet]="generatedTC().expandedRowTempelate"
          [ngTemplateOutletContext]="{ $implicit: product }"
        ></ng-container>
      </td>
    </tr>
  </ng-template>
  }

  <!----------- Defaul Sections ----------->

  <!-- Caption Section -->

  @if (!generatedTC().captionTemplate && generatedTC().showCaption) {
  <ng-template #caption>
    <app-caption [table]="table" />
  </ng-template>
  }

  <!-- Header Section -->

  @if (!generatedTC().headerTemplate) {
  <ng-template #header let-column>
    <app-header
      #appHeader
      [table]="table"
      [expandable]="generatedTC().expandable"
      [selectionMethod]="generatedTC().selectionMethod"
    ></app-header>

    <ng-container
      [ngTemplateOutlet]="appHeader.template"
      [ngTemplateOutletContext]="{ $implicit: column }"
    ></ng-container>
  </ng-template>
  }

  <!-- Body Section -->
  @if (!generatedTC().bodyTemplate) {
  <ng-template #body let-product let-columns="columns" let-expanded="expanded">
    <app-body
      #appBody
      [table]="table"
      [expandable]="generatedTC().expandable"
      [columns]="generatedTC().columns"
      [rowClass]="generatedTC().rowClass"
      [rowStyle]="generatedTC().rowStyle"
      [selectionMethod]="generatedTC().selectionMethod"
    ></app-body>

    <ng-container
      [ngTemplateOutlet]="appBody.template"
      [ngTemplateOutletContext]="{ $implicit: product, columns, expanded }"
    ></ng-container>
  </ng-template>
  }

  <!-- Footer Section -->

  <ng-template pTemplate="footer" let-columns>
    @if (!generatedTC().footerTemplate && generatedTC().showFooter) {
    <app-footer #aggFooterTemplate [table]="table" [aggregation]="generatedTC().aggregationFuncs">
    </app-footer>
    <ng-container [ngTemplateOutlet]="aggFooterTemplate.template"></ng-container>
    }
  </ng-template>
</p-table>

<ng-template #template let-group let-columnCount="columnCount">
      <!-- Group Header Row - Full Width -->
      <tr 
        style="background-color: var(--surface-100); font-weight: 600;"
      >
        <!-- âœ… Checkbox column for group selection -->
        <td style="width: 4rem; text-align: center;">
          <p-checkbox 
            [(ngModel)]="groupSelected"
            [binary]="true"
            (onChange)="onGroupSelectChange($event, group.items)"
          />
        </td>
        
        <!-- Expand/Collapse button -->
        <td style="width: 3rem; text-align: center; cursor: pointer;" (click)="toggleExpand()">
          <p-button
            [icon]="isExpanded() ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
            [text]="true"
            [rounded]="true"
            size="small"
          />
        </td>
        
        <td style="padding: 0.75rem; cursor: pointer;" (click)="toggleExpand()">
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <strong>{{ group.groupKey }}</strong>
          </div>
        </td>
        
        <td style="text-align: center; cursor: pointer;" (click)="toggleExpand()" [attr.colspan]="(columnCount || 1) - 3">
          <p-badge [value]="group.count.toString()" severity="info" />
        </td>
      </tr>
      
      <!-- Column Headers - Shown when group is expanded -->
      @if (isExpanded()) {
        <ng-container [ngTemplateOutlet]="headerTemplate()" 
                      [ngTemplateOutletContext]="{ $implicit: columnsInput() }">
        </ng-container>
      }
    </ng-template>